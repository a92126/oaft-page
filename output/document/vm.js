"use strict";(()=>{var gn=Object.create;var Je=Object.defineProperty;var vn=Object.getOwnPropertyDescriptor;var _n=Object.getOwnPropertyNames;var pn=Object.getPrototypeOf,hn=Object.prototype.hasOwnProperty;var Ze=(u,a)=>()=>(a||u((a={exports:{}}).exports,a),a.exports);var dn=(u,a,n,h)=>{if(a&&typeof a=="object"||typeof a=="function")for(let A of _n(a))!hn.call(u,A)&&A!==n&&Je(u,A,{get:()=>a[A],enumerable:!(h=vn(a,A))||h.enumerable});return u};var Qe=(u,a,n)=>(n=u!=null?gn(pn(u)):{},dn(a||!u||!u.__esModule?Je(n,"default",{value:u,enumerable:!0}):n,u));var er=Ze((se,Re)=>{var Te=function(){var u=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(a){a=a||{};var n=typeof a<"u"?a:{},h,A;n.ready=new Promise(function(e,r){h=e,A=r});var x={},m;for(m in n)n.hasOwnProperty(m)&&(x[m]=n[m]);var k=[],D="./this.program",O=function(e,r){throw r},C=!0,R=!1,H=!1,j=!1,l="";function E(e){return n.locateFile?n.locateFile(e,l):l+e}var g,b,v,F;(C||R)&&(R?l=self.location.href:typeof document<"u"&&document.currentScript&&(l=document.currentScript.src),u&&(l=u),l.indexOf("blob:")!==0?l=l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1):l="",g=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},R&&(v=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),b=function(e,r,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status==200||i.status==0&&i.response){r(i.response);return}t()},i.onerror=t,i.send(null)},F=function(e){document.title=e});var w=n.print||console.log.bind(console),_=n.printErr||console.warn.bind(console);for(m in x)x.hasOwnProperty(m)&&(n[m]=x[m]);x=null,n.arguments&&(k=n.arguments),n.thisProgram&&(D=n.thisProgram),n.quit&&(O=n.quit);var Fn=16;function ur(){return 4}function Tn(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(e[e.length-1]==="*")return ur();if(e[0]==="i"){var r=Number(e.substr(1));return ve(r%8===0,"getNativeTypeSize invalid bits "+r+", type "+e),r/8}else return 0}}}function q(e){q.shown||(q.shown={}),q.shown[e]||(q.shown[e]=1,_(e))}function fr(e,r){if(typeof WebAssembly.Function=="function"){for(var t={i:"i32",j:"i64",f:"f32",d:"f64"},i={parameters:[],results:r[0]=="v"?[]:[t[r[0]]]},o=1;o<r.length;++o)i.parameters.push(t[r[o]]);return new WebAssembly.Function(i,e)}var f=[1,0,1,96],s=r.slice(0,1),c=r.slice(1),p={i:127,j:126,f:125,d:124};f.push(c.length);for(var o=0;o<c.length;++o)f.push(p[c[o]]);s=="v"?f.push(0):f=f.concat([1,p[s]]),f[1]=f.length-2;var U=new Uint8Array([0,97,115,109,1,0,0,0].concat(f,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),I=new WebAssembly.Module(U),fe=new WebAssembly.Instance(I,{e:{f:e}}),ne=fe.exports.f;return ne}var le=[],B;function sr(){if(le.length)return le.pop();try{G.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}return G.length-1}function cr(e,r){for(var t=e;t<e+r;t++){var i=oe(t);i&&B.set(i,t)}}function Rn(e,r){if(B||(B=new WeakMap,cr(0,G.length)),B.has(e))return B.get(e);var t=sr();try{Ge(t,e)}catch(o){if(!(o instanceof TypeError))throw o;var i=fr(e,r);Ge(t,i)}return B.set(e,t),t}function En(e){B.delete(oe(e)),le.push(e)}var Ee=0,xn=function(e){Ee=e},Sn=function(){return Ee},K;n.wasmBinary&&(K=n.wasmBinary);var lr=n.noExitRuntime||!1;typeof WebAssembly!="object"&&X("no native wasm support detected");function Pn(e,r,t,i){switch(t=t||"i8",t.charAt(t.length-1)==="*"&&(t="i32"),t){case"i1":S[e>>0]=r;break;case"i8":S[e>>0]=r;break;case"i16":$[e>>1]=r;break;case"i32":d[e>>2]=r;break;case"i64":de=[r>>>0,(Y=r,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],d[e>>2]=de[0],d[e+4>>2]=de[1];break;case"float":_e[e>>2]=r;break;case"double":pe[e>>3]=r;break;default:X("invalid type for setValue: "+t)}}function Cn(e,r,t){switch(r=r||"i8",r.charAt(r.length-1)==="*"&&(r="i32"),r){case"i1":return S[e>>0];case"i8":return S[e>>0];case"i16":return $[e>>1];case"i32":return d[e>>2];case"i64":return d[e>>2];case"float":return _e[e>>2];case"double":return Number(pe[e>>3]);default:X("invalid type for getValue: "+r)}return null}var me,ge=!1,te;function ve(e,r){e||X("Assertion failed: "+r)}function xe(e){var r=n["_"+e];return ve(r,"Cannot call unknown function "+e+", make sure it is exported"),r}function mr(e,r,t,i,o){var f={string:function(T){var V=0;if(T!=null&&T!==0){var Ke=(T.length<<2)+1;V=re(Ke),Ue(T,V,Ke)}return V},array:function(T){var V=re(T.length);return vr(T,V),V}};function s(T){return r==="string"?Ce(T):r==="boolean"?!!T:T}var c=xe(e),p=[],U=0;if(i)for(var I=0;I<i.length;I++){var fe=f[t[I]];fe?(U===0&&(U=we()),p[I]=fe(i[I])):p[I]=i[I]}var ne=c.apply(null,p);function mn(T){return U!==0&&be(U),s(T)}return ne=mn(ne),ne}function Un(e,r,t,i){t=t||[];var o=t.every(function(s){return s==="number"}),f=r!=="string";return f&&o&&!i?xe(e):function(){return mr(e,r,t,arguments,i)}}var In=0,gr=1;function Mn(e,r){var t;return r==gr?t=re(e.length):t=Ae(e.length),e.subarray||e.slice?N.set(e,t):N.set(new Uint8Array(e),t),t}var Se=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Pe(e,r,t){for(var i=r+t,o=r;e[o]&&!(o>=i);)++o;if(o-r>16&&e.subarray&&Se)return Se.decode(e.subarray(r,o));for(var f="";r<o;){var s=e[r++];if(!(s&128)){f+=String.fromCharCode(s);continue}var c=e[r++]&63;if((s&224)==192){f+=String.fromCharCode((s&31)<<6|c);continue}var p=e[r++]&63;if((s&240)==224?s=(s&15)<<12|c<<6|p:s=(s&7)<<18|c<<12|p<<6|e[r++]&63,s<65536)f+=String.fromCharCode(s);else{var U=s-65536;f+=String.fromCharCode(55296|U>>10,56320|U&1023)}}return f}function Ce(e,r){return e?Pe(N,e,r):""}function ae(e,r,t,i){if(!(i>0))return 0;for(var o=t,f=t+i-1,s=0;s<e.length;++s){var c=e.charCodeAt(s);if(c>=55296&&c<=57343){var p=e.charCodeAt(++s);c=65536+((c&1023)<<10)|p&1023}if(c<=127){if(t>=f)break;r[t++]=c}else if(c<=2047){if(t+1>=f)break;r[t++]=192|c>>6,r[t++]=128|c&63}else if(c<=65535){if(t+2>=f)break;r[t++]=224|c>>12,r[t++]=128|c>>6&63,r[t++]=128|c&63}else{if(t+3>=f)break;r[t++]=240|c>>18,r[t++]=128|c>>12&63,r[t++]=128|c>>6&63,r[t++]=128|c&63}}return r[t]=0,t-o}function Ue(e,r,t){return ae(e,N,r,t)}function ie(e){for(var r=0,t=0;t<e.length;++t){var i=e.charCodeAt(t);i>=55296&&i<=57343&&(i=65536+((i&1023)<<10)|e.charCodeAt(++t)&1023),i<=127?++r:i<=2047?r+=2:i<=65535?r+=3:r+=4}return r}function kn(e){for(var r="";;){var t=N[e++>>0];if(!t)return r;r+=String.fromCharCode(t)}}function Dn(e,r){return Me(e,r,!1)}var Ie=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function On(e,r){for(var t=e,i=t>>1,o=i+r/2;!(i>=o)&&ke[i];)++i;if(t=i<<1,t-e>32&&Ie)return Ie.decode(N.subarray(e,t));for(var f="",s=0;!(s>=r/2);++s){var c=$[e+s*2>>1];if(c==0)break;f+=String.fromCharCode(c)}return f}function Nn(e,r,t){if(t===void 0&&(t=2147483647),t<2)return 0;t-=2;for(var i=r,o=t<e.length*2?t/2:e.length,f=0;f<o;++f){var s=e.charCodeAt(f);$[r>>1]=s,r+=2}return $[r>>1]=0,r-i}function Ln(e){return e.length*2}function Hn(e,r){for(var t=0,i="";!(t>=r/4);){var o=d[e+t*4>>2];if(o==0)break;if(++t,o>=65536){var f=o-65536;i+=String.fromCharCode(55296|f>>10,56320|f&1023)}else i+=String.fromCharCode(o)}return i}function Bn(e,r,t){if(t===void 0&&(t=2147483647),t<4)return 0;for(var i=r,o=i+t-4,f=0;f<e.length;++f){var s=e.charCodeAt(f);if(s>=55296&&s<=57343){var c=e.charCodeAt(++f);s=65536+((s&1023)<<10)|c&1023}if(d[r>>2]=s,r+=4,r+4>o)break}return d[r>>2]=0,r-i}function Wn(e){for(var r=0,t=0;t<e.length;++t){var i=e.charCodeAt(t);i>=55296&&i<=57343&&++t,r+=4}return r}function zn(e){var r=ie(e)+1,t=Ae(r);return t&&ae(e,S,t,r),t}function $n(e){var r=ie(e)+1,t=re(r);return ae(e,S,t,r),t}function Gn(e,r,t){q("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!");var i,o;t&&(o=r+ie(e),i=S[o]),Ue(e,r,1/0),t&&(S[o]=i)}function vr(e,r){S.set(e,r)}function Me(e,r,t){for(var i=0;i<e.length;++i)S[r++>>0]=e.charCodeAt(i);t||(S[r>>0]=0)}function Xn(e,r){return e%r>0&&(e+=r-e%r),e}var Yn,_r,S,N,$,ke,d,pr,_e,pe;function De(e){_r=e,n.HEAP8=S=new Int8Array(e),n.HEAP16=$=new Int16Array(e),n.HEAP32=d=new Int32Array(e),n.HEAPU8=N=new Uint8Array(e),n.HEAPU16=ke=new Uint16Array(e),n.HEAPU32=pr=new Uint32Array(e),n.HEAPF32=_e=new Float32Array(e),n.HEAPF64=pe=new Float64Array(e)}var Vn=5242880,jn=n.INITIAL_MEMORY||16777216,G,Oe=[],Ne=[],Le=[],He=[],Be=[],hr=!1,dr=!1,yr=0;function We(){return lr||yr>0}function Ar(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Rr(n.preRun.shift());Z(Oe)}function wr(){hr=!0,Z(Ne)}function br(){Z(Le)}function Fr(){Z(He),$r(),dr=!0}function Tr(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Er(n.postRun.shift());Z(Be)}function Rr(e){Oe.unshift(e)}function qn(e){Ne.unshift(e)}function Kn(e){Le.unshift(e)}function Jn(e){He.unshift(e)}function Er(e){Be.unshift(e)}var W=0,he=null,J=null;function Zn(e){return e}function xr(e){W++,n.monitorRunDependencies&&n.monitorRunDependencies(W)}function Sr(e){if(W--,n.monitorRunDependencies&&n.monitorRunDependencies(W),W==0&&(he!==null&&(clearInterval(he),he=null),J)){var r=J;J=null,r()}}n.preloadedImages={},n.preloadedAudios={};function X(e){n.onAbort&&n.onAbort(e),e="Aborted("+e+")",_(e),ge=!0,te=1,e+=". Build with -s ASSERTIONS=1 for more info.";var r=new WebAssembly.RuntimeError(e);throw A(r),r}var Pr="data:application/octet-stream;base64,";function ze(e){return e.startsWith(Pr)}function Qn(e){return e.startsWith("file://")}var P;P="nba.wasm",ze(P)||(P=E(P));function $e(e){try{if(e==P&&K)return new Uint8Array(K);if(v)return v(e);throw"both async and sync fetching of the wasm failed"}catch(r){X(r)}}function Cr(){return!K&&(C||R)&&typeof fetch=="function"?fetch(P,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+P+"'";return e.arrayBuffer()}).catch(function(){return $e(P)}):Promise.resolve().then(function(){return $e(P)})}function Ur(){var e={env:Ye,wasi_snapshot_preview1:Ye};function r(s,c){var p=s.exports;n.asm=p,me=n.asm.memory,De(me.buffer),G=n.asm.__indirect_function_table,Sr("wasm-instantiate")}xr("wasm-instantiate");function t(s){r(s.instance)}function i(s){return Cr().then(function(c){return WebAssembly.instantiate(c,e)}).then(function(c){return c}).then(s,function(c){_("failed to asynchronously prepare wasm: "+c),X(c)})}function o(){return!K&&typeof WebAssembly.instantiateStreaming=="function"&&!ze(P)&&typeof fetch=="function"?fetch(P,{credentials:"same-origin"}).then(function(s){var c=WebAssembly.instantiateStreaming(s,e);return c.then(t,function(p){return _("wasm streaming compile failed: "+p),_("falling back to ArrayBuffer instantiation"),i(t)})}):i(t)}if(n.instantiateWasm)try{var f=n.instantiateWasm(e,r);return f}catch(s){return _("Module.instantiateWasm callback failed with error: "+s),!1}return o().catch(A),{}}var Y,de,et={};function Z(e){for(;e.length>0;){var r=e.shift();if(typeof r=="function"){r(n);continue}var t=r.func;typeof t=="number"?r.arg===void 0?oe(t)():oe(t)(r.arg):t(r.arg===void 0?null:r.arg)}}function rt(e){var r=we(),t=e();return be(r),t}function nt(e){return e}function Ir(e){var r=/\b_Z[\w\d_]+/g;return e.replace(r,function(t){var i=t;return t===i?t:i+" ["+t+"]"})}var Q=[];function oe(e){var r=Q[e];return r||(e>=Q.length&&(Q.length=e+1),Q[e]=r=G.get(e)),r}function Mr(e){if(e instanceof Ve||e=="unwind")return te;O(1,e)}function kr(){var e=new Error;if(!e.stack){try{throw new Error}catch(r){e=r}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function Ge(e,r){G.set(e,r),Q[e]=r}function tt(){var e=kr();return n.extraStackTrace&&(e+=`
`+n.extraStackTrace()),Ir(e)}var z={mappings:{},buffers:[null,[],[]],printChar:function(e,r){var t=z.buffers[e];r===0||r===10?((e===1?w:_)(Pe(t,0)),t.length=0):t.push(r)},varargs:void 0,get:function(){z.varargs+=4;var e=d[z.varargs-4>>2];return e},getStr:function(e){var r=Ce(e);return r},get64:function(e,r){return e}};function Dr(e,r){}var Xe;Xe=function(){return performance.now()};var Or=!0;function Nr(e){return e==0||e==1||e==2||e==3}function Lr(e,r,t,i){if(!Nr(e))return 28;var o;if(e===0)o=Date.now();else if(Or)o=Xe();else return 52;var f=Math.round(o*1e3*1e3);return d[i>>2]=f>>>0,d[i+4>>2]=f/Math.pow(2,32)>>>0,0}function Hr(e){De(me.buffer)}var ye={};function Br(){return D||"./this.program"}function ee(){if(!ee.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Br()};for(var t in ye)ye[t]===void 0?delete r[t]:r[t]=ye[t];var i=[];for(var t in r)i.push(t+"="+r[t]);ee.strings=i}return ee.strings}function Wr(e,r){var t=0;return ee().forEach(function(i,o){var f=r+t;d[e+o*4>>2]=f,Me(i,f),t+=i.length+1}),0}function zr(e,r){var t=ee();d[e>>2]=t.length;var i=0;return t.forEach(function(o){i+=o.length+1}),d[r>>2]=i,0}function $r(){typeof _fflush<"u"&&_fflush(0);var e=z.buffers;e[1].length&&z.printChar(1,10),e[2].length&&z.printChar(2,10)}function Gr(e,r,t,i){for(var o=0,f=0;f<t;f++){var s=d[r>>2],c=d[r+4>>2];r+=8;for(var p=0;p<c;p++)z.printChar(e,N[s+p]);o+=c}return d[i>>2]=o,0}function Xr(e){je(e)}var Yr=!1;function at(e,r,t){var i=t>0?t:ie(e)+1,o=new Array(i),f=ae(e,o,0,o.length);return r&&(o.length=f),o}function it(e){for(var r=[],t=0;t<e.length;t++){var i=e[t];i>255&&(Yr&&ve(!1,"Character code "+i+" ("+String.fromCharCode(i)+")  at offset "+t+" not in 0x00-0xFF."),i&=255),r.push(String.fromCharCode(i))}return r.join("")}var Ye={__syscall_stat64:Dr,clock_time_get:Lr,emscripten_notify_memory_growth:Hr,environ_get:Wr,environ_sizes_get:zr,fd_write:Gr,proc_exit:Xr},ot=Ur(),Vr=n._getRom=function(){return(Vr=n._getRom=n.asm.getRom).apply(null,arguments)},Ae=n._malloc=function(){return(Ae=n._malloc=n.asm.malloc).apply(null,arguments)},jr=n._getIRam=function(){return(jr=n._getIRam=n.asm.getIRam).apply(null,arguments)},qr=n._getWRam=function(){return(qr=n._getWRam=n.asm.getWRam).apply(null,arguments)},Kr=n._cyclePerFrame=function(){return(Kr=n._cyclePerFrame=n.asm.cyclePerFrame).apply(null,arguments)},Jr=n._getOutput=function(){return(Jr=n._getOutput=n.asm.getOutput).apply(null,arguments)},Zr=n._run=function(){return(Zr=n._run=n.asm.run).apply(null,arguments)},Qr=n._go=function(){return(Qr=n._go=n.asm.go).apply(null,arguments)},en=n._replay=function(){return(en=n._replay=n.asm.replay).apply(null,arguments)},rn=n._main=function(){return(rn=n._main=n.asm.main).apply(null,arguments)},nn=n.__start=function(){return(nn=n.__start=n.asm._start).apply(null,arguments)},tn=n.___errno_location=function(){return(tn=n.___errno_location=n.asm.__errno_location).apply(null,arguments)},an=n.__get_tzname=function(){return(an=n.__get_tzname=n.asm._get_tzname).apply(null,arguments)},on=n.__get_daylight=function(){return(on=n.__get_daylight=n.asm._get_daylight).apply(null,arguments)},un=n.__get_timezone=function(){return(un=n.__get_timezone=n.asm._get_timezone).apply(null,arguments)},we=n.stackSave=function(){return(we=n.stackSave=n.asm.stackSave).apply(null,arguments)},be=n.stackRestore=function(){return(be=n.stackRestore=n.asm.stackRestore).apply(null,arguments)},re=n.stackAlloc=function(){return(re=n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},ue;function Ve(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}var fn=!1,sn=void 0;J=function e(){ue||Fe(),ue||(J=e)};function cn(e){var r=n.__start;sn=[D].concat(e);try{r();var t=0;return ln(t,!0),t}catch(i){return Mr(i)}finally{fn=!0}}function Fe(e){if(e=e||k,W>0||(Ar(),W>0))return;function r(){ue||(ue=!0,n.calledRun=!0,!ge&&(wr(),br(),h(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),qe&&cn(e),Tr()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),r()},1)):r()}n.run=Fe;function ln(e,r){te=e,We()||Fr(),je(e)}function je(e){te=e,We()||(n.onExit&&n.onExit(e),ge=!0),O(e,new Ve(e))}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var qe=!0;return n.noInitialRun&&(qe=!1),Fe(),a.ready}}();typeof se=="object"&&typeof Re=="object"?Re.exports=Te:typeof define=="function"&&define.amd?define([],function(){return Te}):typeof se=="object"&&(se.createNanoBA=Te)});var or=Ze((ft,ir)=>{var rr=Qe(er()),nr=()=>{let u=null,a=new WritableStream({start(n){this.buffer=new Uint8Array(1024),this.pos=0},write(n,h){if(this.buffer.byteLength-this.pos<n.byteLength){let x=this.buffer;this.buffer=new Uint8Array(Math.max(x.byteLength*2,n.byteLength*2)),this.buffer.set(x,0)}this.buffer.set(n,this.pos),this.pos+=n.byteLength},close(){u=this.buffer=this.buffer.slice(0,this.pos)}});return Object.defineProperty(a,"bytes",{get:()=>u}),a},yn=async u=>{let a=await fetch(u),n=nr();return await a.body.pipeThrough(new DecompressionStream("gzip")).pipeTo(n),n.bytes},L=async()=>{if(L[Symbol.for("vm")])return L[Symbol.for("vm")];if(L[Symbol.for("pending")])return L[Symbol.for("pending")];let u,a,n=async()=>{try{let A=await(await fetch("/r/nba.js")).text(),x=await yn("/r/nba.hex"),m={};await(()=>new Promise(l=>{m.wasmBinary=x.buffer,m.onRuntimeInitialized=l,(0,rr.default)(m)}))();let[k,D,O,C]=[m._getIRam(),m._getWRam(),m._cyclePerFrame(),m._getOutput()],R=0,H=0,j=!1;L[Symbol.for("vm")]={setRom(l){H=l.byteLength,R=m._getRom(H),m.HEAPU8.set(new Uint8Array(l),R)},go(l,E){j?m._run(Math.round(l*O),E??0):(j=!0,m._go(l,E??0))},output(l){let E=C>>2;return E?m.HEAPU32[E+l]:0},raw(){return m.HEAPU8.buffer},replay(){return m._replay()},u8At(l){return 33554432<=l&&l<=33816575?m.HEAPU8[l-33554432+D]:50331648<=l&&l<=50364415?m.HEAPU8[l-50331648+k]:134217728<=l&&l<134217728+H?m.HEAPU8[l-134217728+R]:null},u32At(l){let E=g=>g>>2;return 33554432<=l&&l<=33816575?m.HEAPU32[E(l-33554432+D)]:50331648<=l&&l<=50364415?m.HEAPU32[E(l-50331648+k)]:134217728<=l&&l<134217728+H?m.HEAPU32[E(l-134217728+R)]:null}},u(L[Symbol.for("vm")])}catch(h){console.error("load nano boy adv error",h.stack),a(h)}};return L[Symbol.for("pending")]=new Promise((h,A)=>{u=h,a=A,n()})},tr=(u,a)=>a?{type:u,payloads:a}:{type:u},An=(u,...a)=>tr(ar.NANOBOY_RPC,[u,a]),ar={NANOBOY_READY:0,NANOBOY_RPC:1};ir.exports={loadNanoBA:L,makeMessage:tr,makeRPC:An,MessageType:ar,streamToMemory:nr}});var M=Qe(or()),ce;(0,M.loadNanoBA)().then(u=>{ce=u,self.postMessage((0,M.makeMessage)(M.MessageType.NANOBOY_READY))});var wn=63,bn=u=>{let a=null,n={},h=()=>{n.program&&a.deleteProgram(n.program),n.buffer&&a.deleteBuffer(buffer),n.texture&&a.deleteTexture(n.texture),n={}},A=(g,b)=>{let v=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(v,g),a.compileShader(v),!a.getShaderParameter(v,a.COMPILE_STATUS)){let _=a.getShaderInfoLog(v);throw a.deleteShader(v),new Error(`Compile vs: ${_}`)}let F=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(F,b),a.compileShader(F),!a.getShaderParameter(F,a.COMPILE_STATUS)){let _=a.getShaderInfoLog(F);throw a.deleteShader(F),new Error(`Compile fs: ${_}`)}let w=a.createProgram();if(a.attachShader(w,v),a.attachShader(w,F),a.linkProgram(w),a.detachShader(w,v),a.detachShader(w,F),a.deleteShader(v),a.deleteShader(F),a.getProgramParameter(w,a.LINK_STATUS))return w;{let _=a.getProgramInfoLog(w);throw a.deleteProgram(w),new Error(`Link shader: ${_}`)}},x=(g,b)=>{a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),n.program=A(g,b),a.useProgram(n.program),n.buffer=n.buffer??a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,n.buffer);let v=a.getAttribLocation(n.program,"texcoord");a.vertexAttribPointer(v,2,a.FLOAT,!0,8,0),a.enableVertexAttribArray(v),n.texture=n.texture??a.createTexture(),a.bindTexture(a.TEXTURE_2D,n.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,240,160,0,a.RGBA,a.UNSIGNED_BYTE,null)},m=()=>{},k=()=>{a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,240,160,a.RGBA,a.UNSIGNED_BYTE,n.data);let g=a.getUniformLocation(n.program,"gbapic");a.uniform1i(g,0)},D=g=>{a.bufferData(a.ARRAY_BUFFER,g,a.STATIC_DRAW)},O=()=>{a.drawArrays(a.TRIANGLE_STRIP,0,4)},C=[],R=g=>{let b=n.now;n.now=g;let v=1,F=n.keyboard,w=performance.now();u.go(v,F),C.push(performance.now()-w);let _=u.output(0);_&&(n.data=new Uint8Array(u.raw(),_,4*240*160),k(),O()),E(),u.stop||(u.fps(1e3/(g-n.prev)),requestAnimationFrame(R)),n.prev=g},H=()=>{u.stop=!0,n.stop=performance.now(),console.log(`\u603B\u5171\u8FD0\u884C${C.length}\u5E27`),C.sort((b,v)=>b-v),console.log(`\u6700\u6162\u5E27${C.at(-1)}ms`);let g=C.filter(b=>b>16.6);console.log(`\u8D85\u8FC716.6\u5171\u8BA1${g.length}\u5E27`)},j=()=>{u.stop&&(u.stop=!1,n.now=performance.now(),delete n.stop,requestAnimationFrame(R))},l=(g,b)=>{b?n.keyboard|=1<<g:n.keyboard&=wn&~(1<<g)},E=()=>{};return(g,[b,v],F)=>{a!=null&&a!=g&&h();let w=u.output();n.data=new Uint8Array(u.raw(),w,4*240*160),n.prev=n.now=performance.now(),n.keyboard=0,a=g;try{x(b,v),m(),k(),D(F),O()}catch(_){throw console.error(_.stack),_}return requestAnimationFrame(R),[H,j,l]}},y={$internal:{},setRom(u){ce.setRom(u)},scene(u,a,n,h){y.$internal.gl=u.getContext("webgl"),y.$internal.shader=[a,n],y.$internal.mesh=new Float32Array(h)},start(){let u=bn(ce);ce.fps=n=>{self.postMessage((0,M.makeRPC)("fps",n))};let a=u(y.$internal.gl,y.$internal.shader,y.$internal.mesh);y.$internal.pause=a[0],y.$internal.resume=a[1],y.$internal.input=a[2]},input(u,a){y.$internal.input&&y.$internal.input(u,a)},pause(){y.$internal.pause&&y.$internal.pause()},resume(){y.$internal.resume&&y.$internal.resume()}};self.onmessage=u=>{let a=u.data;switch(a.type){case M.MessageType.NANOBOY_RPC:{let[n,h]=a.payloads;n in y&&y[n].apply(y,h);break}default:}};})();
